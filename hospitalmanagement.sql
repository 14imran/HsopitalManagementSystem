--------------------------------------------------------
--  File created - Thursday-August-11-2022   
--------------------------------------------------------
--------------------------------------------------------
--  DDL for Table PATIENT_DIAGNOSIS
--------------------------------------------------------

  CREATE TABLE "SYSTEM"."PATIENT_DIAGNOSIS" 
   (	"DIAG_ID" VARCHAR2(15 CHAR), 
	"DIAG_DETAILS" VARCHAR2(180 CHAR), 
	"DIAG_REMARKS" VARCHAR2(180 CHAR), 
	"DIAG_DATE" DATE, 
	"PATIENT_ID" VARCHAR2(15 CHAR)
   ) PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM" ;
--------------------------------------------------------
--  DDL for Table PATIENT
--------------------------------------------------------

  CREATE TABLE "SYSTEM"."PATIENT" 
   (	"PATIENT_ID" VARCHAR2(12 CHAR), 
	"PATIENT_NAME" VARCHAR2(65 CHAR), 
	"PATIENT_GENDER" VARCHAR2(21 CHAR), 
	"PATIENT_ADDRESS" VARCHAR2(102 CHAR), 
	"PATIENT_NUMBER" NUMBER(21,0), 
	"PATIENT_DOC_CODE" VARCHAR2(20 CHAR)
   ) PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM" ;
--------------------------------------------------------
--  DDL for Table DOCTOR
--------------------------------------------------------

  CREATE TABLE "SYSTEM"."DOCTOR" 
   (	"DOC_CODE" VARCHAR2(15 CHAR), 
	"DOC_NAME" VARCHAR2(65 CHAR), 
	"DOC_GENDER" VARCHAR2(8 CHAR), 
	"DOC_ADDRESS" VARCHAR2(180 CHAR), 
	"DOC_DESIGNATION" VARCHAR2(40 CHAR), 
	"DOC_NUMBER" NUMBER(21,0)
   ) PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM" ;
--------------------------------------------------------
--  DDL for Table BILL
--------------------------------------------------------

  CREATE TABLE "SYSTEM"."BILL" 
   (	"BILL_NO" NUMBER(*,0), 
	"PATIENT_ID" VARCHAR2(15 CHAR), 
	"PATIENT_NAME" VARCHAR2(65 CHAR), 
	"PATIENT_GENDER" VARCHAR2(12 CHAR), 
	"PATIENT_ADDRESS" VARCHAR2(180 CHAR), 
	"DOC_NAME" VARCHAR2(65 CHAR), 
	"AMOUNT" NUMBER(21,10)
   ) PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM" ;
REM INSERTING into SYSTEM.PATIENT_DIAGNOSIS
SET DEFINE OFF;
Insert into SYSTEM.PATIENT_DIAGNOSIS (DIAG_ID,DIAG_DETAILS,DIAG_REMARKS,DIAG_DATE,PATIENT_ID) values ('DIAG031','Suffering from Covid19','Need to use oxygen',to_date('10-AUG-22','DD-MON-RR'),'P031');
Insert into SYSTEM.PATIENT_DIAGNOSIS (DIAG_ID,DIAG_DETAILS,DIAG_REMARKS,DIAG_DATE,PATIENT_ID) values ('DIAG032','Suffering from lung disease','Treatments surgery.',to_date('10-AUG-22','DD-MON-RR'),'P032');
Insert into SYSTEM.PATIENT_DIAGNOSIS (DIAG_ID,DIAG_DETAILS,DIAG_REMARKS,DIAG_DATE,PATIENT_ID) values ('DIAG033','Suffering from monkeypox diseases','Use vaccine',to_date('10-AUG-22','DD-MON-RR'),'P033');
Insert into SYSTEM.PATIENT_DIAGNOSIS (DIAG_ID,DIAG_DETAILS,DIAG_REMARKS,DIAG_DATE,PATIENT_ID) values ('DIAG034','Suffering from mouth cancer','Need to use pain killers',to_date('10-AUG-22','DD-MON-RR'),'P034');
Insert into SYSTEM.PATIENT_DIAGNOSIS (DIAG_ID,DIAG_DETAILS,DIAG_REMARKS,DIAG_DATE,PATIENT_ID) values ('DIAG035','Suffering from migrane','Avoid stress, sleep well',to_date('10-AUG-22','DD-MON-RR'),'P035');
Insert into SYSTEM.PATIENT_DIAGNOSIS (DIAG_ID,DIAG_DETAILS,DIAG_REMARKS,DIAG_DATE,PATIENT_ID) values ('DIAG036','Suffering from ulcer','Need to use pain killers',to_date('10-AUG-22','DD-MON-RR'),'P036');
REM INSERTING into SYSTEM.PATIENT
SET DEFINE OFF;
Insert into SYSTEM.PATIENT (PATIENT_ID,PATIENT_NAME,PATIENT_GENDER,PATIENT_ADDRESS,PATIENT_NUMBER,PATIENT_DOC_CODE) values ('P031','John Key','M','#343, California',125231,'D031');
Insert into SYSTEM.PATIENT (PATIENT_ID,PATIENT_NAME,PATIENT_GENDER,PATIENT_ADDRESS,PATIENT_NUMBER,PATIENT_DOC_CODE) values ('P032','Bob Ray','M','#127, Texas',125232,'D032');
Insert into SYSTEM.PATIENT (PATIENT_ID,PATIENT_NAME,PATIENT_GENDER,PATIENT_ADDRESS,PATIENT_NUMBER,PATIENT_DOC_CODE) values ('P033','Key Rob','F','#984, Utah',125233,'D033');
Insert into SYSTEM.PATIENT (PATIENT_ID,PATIENT_NAME,PATIENT_GENDER,PATIENT_ADDRESS,PATIENT_NUMBER,PATIENT_DOC_CODE) values ('P034','Wilson Jay','M','#454, Miami ',125234,'D034');
Insert into SYSTEM.PATIENT (PATIENT_ID,PATIENT_NAME,PATIENT_GENDER,PATIENT_ADDRESS,PATIENT_NUMBER,PATIENT_DOC_CODE) values ('P035','Andy San','M','#121, IL',125235,'D035');
Insert into SYSTEM.PATIENT (PATIENT_ID,PATIENT_NAME,PATIENT_GENDER,PATIENT_ADDRESS,PATIENT_NUMBER,PATIENT_DOC_CODE) values ('P036','Dona Paul','F','#323, IL',125236,'D036');
REM INSERTING into SYSTEM.DOCTOR
SET DEFINE OFF;
Insert into SYSTEM.DOCTOR (DOC_CODE,DOC_NAME,DOC_GENDER,DOC_ADDRESS,DOC_DESIGNATION,DOC_NUMBER) values ('D031','Dr Sarah Abelson','M','125, Mayo Clinic, Illinois','General Surgeon',10506571);
Insert into SYSTEM.DOCTOR (DOC_CODE,DOC_NAME,DOC_GENDER,DOC_ADDRESS,DOC_DESIGNATION,DOC_NUMBER) values ('D032','Dr Geri Aitken','M','452, Cleveland Clinic, California','Cardiologist',100188336);
Insert into SYSTEM.DOCTOR (DOC_CODE,DOC_NAME,DOC_GENDER,DOC_ADDRESS,DOC_DESIGNATION,DOC_NUMBER) values ('D033','Dr Jacqueline Pongracic','F','764,UCLA Medical, Los Angeles','Dermatologist',142795770);
Insert into SYSTEM.DOCTOR (DOC_CODE,DOC_NAME,DOC_GENDER,DOC_ADDRESS,DOC_DESIGNATION,DOC_NUMBER) values ('D034','Dr Brian Cole','M','714, Massachusetts General Hospital, Boston','Oral Surgeon',170188336);
Insert into SYSTEM.DOCTOR (DOC_CODE,DOC_NAME,DOC_GENDER,DOC_ADDRESS,DOC_DESIGNATION,DOC_NUMBER) values ('D035','Dr Joanne Smith','M','354,Cedars-Sinai, Manhattan','Neurologist',120766036);
Insert into SYSTEM.DOCTOR (DOC_CODE,DOC_NAME,DOC_GENDER,DOC_ADDRESS,DOC_DESIGNATION,DOC_NUMBER) values ('D036','Dr Santiago Horgan','M','232,NewYork-Presbyterian, NewYork','Neurologist',160766036);
REM INSERTING into SYSTEM.BILL
SET DEFINE OFF;
--------------------------------------------------------
--  DDL for Index PK_PATIENT_DIAGNOSIS
--------------------------------------------------------

  CREATE UNIQUE INDEX "SYSTEM"."PK_PATIENT_DIAGNOSIS" ON "SYSTEM"."PATIENT_DIAGNOSIS" ("DIAG_ID") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM" ;
--------------------------------------------------------
--  DDL for Index PK_PATIENT
--------------------------------------------------------

  CREATE UNIQUE INDEX "SYSTEM"."PK_PATIENT" ON "SYSTEM"."PATIENT" ("PATIENT_ID") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM" ;
--------------------------------------------------------
--  DDL for Index UQ_DOC_CODE
--------------------------------------------------------

  CREATE UNIQUE INDEX "SYSTEM"."UQ_DOC_CODE" ON "SYSTEM"."PATIENT" ("PATIENT_DOC_CODE") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM" ;
--------------------------------------------------------
--  DDL for Index PK_DOCTOR
--------------------------------------------------------

  CREATE UNIQUE INDEX "SYSTEM"."PK_DOCTOR" ON "SYSTEM"."DOCTOR" ("DOC_CODE") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM" ;
--------------------------------------------------------
--  DDL for Index PK_BILL
--------------------------------------------------------

  CREATE UNIQUE INDEX "SYSTEM"."PK_BILL" ON "SYSTEM"."BILL" ("BILL_NO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM" ;
--------------------------------------------------------
--  DDL for Trigger BILL_TRG
--------------------------------------------------------

  CREATE OR REPLACE NONEDITIONABLE TRIGGER "SYSTEM"."BILL_TRG" 
BEFORE INSERT ON BILL
FOR EACH ROW
DECLARE
DOC_ID VARCHAR(10 CHAR);
BEGIN
IF :NEW.BILL_NO IS NULL THEN
     SELECT BILL_NO_SEQ.NEXTVAL INTO :NEW.BILL_NO FROM DUAL;
END IF;
IF :NEW.PATIENT_NAME IS NULL THEN
     SELECT PATIENT_NAME INTO :NEW.PATIENT_NAME FROM PATIENT WHERE PATIENT_ID=:NEW.PATIENT_ID;
END IF;
IF :NEW.PATIENT_GENDER IS NULL THEN
     SELECT PATIENT_GENDER INTO :NEW.PATIENT_GENDER FROM PATIENT WHERE PATIENT_ID=:NEW.PATIENT_ID;
END IF;
IF :NEW.PATIENT_ADDRESS IS NULL THEN
     SELECT PATIENT_ADDRESS INTO :NEW.PATIENT_ADDRESS FROM PATIENT WHERE PATIENT_ID=:NEW.PATIENT_ID;
END IF;
IF :NEW.DOC_NAME IS NULL THEN
     SELECT PATIENT_DOC_CODE INTO DOC_ID FROM PATIENT WHERE PATIENT_ID=:NEW.PATIENT_ID;
	 SELECT DOC_NAME INTO :NEW.DOC_NAME FROM DOCTOR WHERE DOC_CODE = DOC_ID;
END IF;
END;
/
ALTER TRIGGER "SYSTEM"."BILL_TRG" ENABLE;
--------------------------------------------------------
--  Constraints for Table PATIENT_DIAGNOSIS
--------------------------------------------------------

  ALTER TABLE "SYSTEM"."PATIENT_DIAGNOSIS" ADD CONSTRAINT "PK_PATIENT_DIAGNOSIS" PRIMARY KEY ("DIAG_ID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM"  ENABLE;
--------------------------------------------------------
--  Constraints for Table PATIENT
--------------------------------------------------------

  ALTER TABLE "SYSTEM"."PATIENT" ADD CONSTRAINT "PK_PATIENT" PRIMARY KEY ("PATIENT_ID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM"  ENABLE;
  ALTER TABLE "SYSTEM"."PATIENT" ADD CONSTRAINT "UQ_DOC_CODE" UNIQUE ("PATIENT_DOC_CODE")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM"  ENABLE;
--------------------------------------------------------
--  Constraints for Table DOCTOR
--------------------------------------------------------

  ALTER TABLE "SYSTEM"."DOCTOR" ADD CONSTRAINT "PK_DOCTOR" PRIMARY KEY ("DOC_CODE")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM"  ENABLE;
--------------------------------------------------------
--  Constraints for Table BILL
--------------------------------------------------------

  ALTER TABLE "SYSTEM"."BILL" ADD CONSTRAINT "PK_BILL" PRIMARY KEY ("BILL_NO")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM"  ENABLE;
--------------------------------------------------------
--  Ref Constraints for Table PATIENT_DIAGNOSIS
--------------------------------------------------------

  ALTER TABLE "SYSTEM"."PATIENT_DIAGNOSIS" ADD CONSTRAINT "FK_PATIENT_ID" FOREIGN KEY ("PATIENT_ID")
	  REFERENCES "SYSTEM"."PATIENT" ("PATIENT_ID") ENABLE;
--------------------------------------------------------
--  Ref Constraints for Table DOCTOR
--------------------------------------------------------

  ALTER TABLE "SYSTEM"."DOCTOR" ADD CONSTRAINT "FK_DOC_CODE" FOREIGN KEY ("DOC_CODE")
	  REFERENCES "SYSTEM"."PATIENT" ("PATIENT_DOC_CODE") ENABLE;
--------------------------------------------------------
--  Ref Constraints for Table BILL
--------------------------------------------------------

  ALTER TABLE "SYSTEM"."BILL" ADD CONSTRAINT "FK_BILL_PATIENT_ID" FOREIGN KEY ("PATIENT_ID")
	  REFERENCES "SYSTEM"."PATIENT" ("PATIENT_ID") ENABLE;
